{
    "name": "[CasperID] Unusual Verification Failure Spike",
    "type": "metric alert",
    "query": "avg(last_10m):sum:casperid.verification.result{outcome:failed}.as_rate() > 1",
    "message": "⚠️ ALERT: High Verification Failure Rate\n\n**Failed Verifications:** {{value}} per second\n**Normal Rate:** < 0.2/sec\n**Service:** casperid-api\n\n**Potential Issues:**\n- Batch of poor quality documents\n- API integration problem\n- Gemini API degradation\n- Suspicious activity pattern\n\n**Investigation Steps:**\n1. Check dashboard for top rejection reasons\n2. Review recent verification requests\n3. Validate API configuration\n4. Check for unusual traffic patterns\n\n**Security Note:** High failure rates can indicate:\n- Automated attack attempts\n- Credential stuffing\n- Data quality issues\n\nIf suspicious, escalate to security team.\n\n**Dashboard:** CasperID LLM Health → Top Rejection Reasons\n\n@devops-oncall @slack-casperid-alerts",
    "tags": [
        "verification",
        "failures",
        "casperid-api",
        "security"
    ],
    "options": {
        "notify_audit": false,
        "locked": false,
        "timeout_h": 0,
        "include_tags": true,
        "no_data_timeframe": 15,
        "require_full_window": false,
        "new_host_delay": 300,
        "notify_no_data": false,
        "renotify_interval": 60,
        "thresholds": {
            "critical": 1,
            "warning": 0.5
        }
    },
    "priority": 2
}